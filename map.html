<html>

<head>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
 integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
 crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
 integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
 crossorigin=""></script>
<script src="data.js"></script>

<style>
#map {
    height: 100%;
    background: black;
}

.input-div {
	position: relative;
	float: left;
	background: #fff;
	color: #1978cf;
	border: 2px solid rgba(0,0,0,0.2);
	background-clip: padding-box;
	-moz-border-radius: 4px;
	-webkit-border-radius: 4px;
	border-radius: 4px;
	background-color: rgba(255, 255, 255, 0.8);
	z-index: 1000;	
	margin-left: 10px;
	margin-top: 10px;
}

.input-div .input-box {
    display: block;
	float: left;
	background: #fff;
	border: 1px solid #666;
	border-radius: 2px;
	height: 22px;
	padding: 0 20px 0 2px;
	margin: 4px 4px 4px 4px;
}
</style>

</head>

<body>
<div id="map"></div>
<script>

var name = 'Olivier';

var Input = L.Control.extend({
    options: {
        position: 'topright'
    },
    container: null,
    onAdd: function(map) {
        this.container = L.DomUtil.create('div', 'input-div');

        var input = L.DomUtil.create('input', 'input-box', this.container);
        input.type = 'text';
        input.size = 20;
        input.value = name;

        L.DomEvent.disableClickPropagation(this.container);
        L.DomEvent.on(this.container, 'contextmenu', function(ev) {
            L.DomEvent.stopPropagation(ev);
        });
        L.DomEvent.disableScrollPropagation(this.container);
        L.DomEvent.on(input, 'input', function(ev) {
            name = ev.target.value
                     .normalize('NFD').replace(/[\u0300-\u036f]/g, '')
                     .replace(/\b\w/g, function(s){ return s.toUpperCase() });
            ev.target.value = name;
            geojson.setStyle(style);
        });
        return this.container;
    },
});

function style(commune) {

    var density = (name in commune.properties.data) ? (commune.properties.data[name] / commune.properties.size) : 0;
    var color = 'hsl(60, 100%, 50%)';

    if (density > 0.020) color = 'hsl(0, 100%, 30%)';
    else if (density > 0.015) color = 'hsl(0, 100%, 40%)';
    else if (density > 0.010) color = 'hsl(0, 100%, 50%)';
    else if (density > 0.005) color = 'hsl(10, 100%, 50%)';
    else if (density > 0.004) color = 'hsl(25, 100%, 50%)';
    else if (density > 0.003) color = 'hsl(30, 100%, 50%)';
    else if (density > 0.002) color = 'hsl(35, 100%, 50%)';
    else if (density > 0.001) color = 'hsl(40, 100%, 50%)';
    else if (density > 0.000) color = 'hsl(45, 100%, 50%)';

    return {
        fillColor: color,
        weight: 0.5,
        opacity: 1,
        color: 'white',
        fillOpacity: 0.7
    };
}




var map = L.map('map', {
    attributionControl: false,
    center: [50.5, 4.5],
    closePopupOnClick: false,
    maxBounds: [[48.4, 1.5], [52.6, 7.5]],
    maxZoom: 11,
    minZoom: 7,
    zoom: 7.7,
    zoomSnap: 0.1,
});
map.fitBounds([[49.4, 2.5], [51.6, 6.5]]);
var geojson = L.geoJson(data, { style: style }).addTo(map);
var input = new Input().addTo(map);

/*
info.addTo(map);
var info = L.control();
info.onAdd = function(map) {
    this._div = L.DomUtil.create('div', 'info');
    this.update();
    return this._div;
};

info.update = function(props) {
    this._div.innerHTML = '<h4>' + (props ? props.name+' '+props.data[name]+' '+props.data[name]/props.size : 'Test') + '</h4>';
};

function onEachFeature(feature, layer) {
    layer.on({
        mouseover: function(e) {
            e.target.setStyle({
                weight: 5,
                color: 'green',
                fillOpacity: 0.7
            });
            e.target.bringToFront();
            info.update(e.target.feature.properties);
        },
        mouseout: function(e) {
            geojson.resetStyle(e.target);
            info.update();
        }
    });
}
*/






</script>
</body>

</html>
